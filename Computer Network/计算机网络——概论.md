---
title: 计算机网络——概论
date: 2021-3-18 22:14:55
tags: 
- Computer Network
categories:
- Computer Network
toc: true
reward: true
---

<!--more-->

## 1.1 因特网

### 基本组成

- 连入因特网的设备称为**主机**或者**端系统**，端系统通过**通信链路**和**分组交换机**连接到一起。
- 分组交换机最常见的类型是**路由器**和**链路层交换机**，作用是**转发分组**；链路层交换机一般位于**接入网**中，而路由器则位于**网络核心**。
- 端系统通过**因特网服务提供商（ISP）**接入因特网，每个 ISP 自身就是一个由多台分组交换机和多段通信链路组成的网络，所以因特网是**网络的网络**。为了端系统的彼此互联，每个（独立管理的）ISP 之间也必须互联。
- 端系统、分组交换机和其他因特网部件都要运行一系列**协议**，这些协议控制因特网中信息的**接收**和**发送**。其中 **TCP**（传输控制协议）和 **IP**（网际协议）是因特网中最为重要的两个协议，故因特网的主要协议统称为 **TCP/IP**。
- 因特网标准由因特网工程任务组（IETF）研发，标准文档称为**请求评论**（RFC）。

### 服务描述

- 我们也可以通过*为应用程序提供服务的基础设施*的角度来描述因特网，即因特网为应用程序的平台。
- 因特网应用程序运行在**端系统**而非分组交换机中。
- 与因特网相连的端系统提供了一个**套接字接口**，该接口规定了运行在一个端系统上的程序 请求因特网基础设施 向运行在另一个端系统上的特定目的地程序 交付数据的方式。因特网套接字接口是一套发送程序必须遵循的规则集合，因此因特网能够将数据交付给目的地。

### 协议

**定义**：协议定义了在两个或多个通信实体之间交换的报文的**格式**和**顺序**，以及报文发送和/或接收一条报文或其他时间所采取的**动作**。

可以说，协议是两个通信实体间为完成通信任务而采取的一系列**约定**，所以两个通信实体应运行**相同**的协议。

### 常见类型

- 个域网（PAN）：蓝牙耳机
- 局域网（LAN）：< 10km，办公楼内网络
- 城域网（WAN）：10 ~ 100km，药大 VPN
- 广域网（WAN）：跨越国界、洲界等

## 1.2 网络边缘

端系统也称为主机，因为它们容纳（运行）应用程序；主机也分为**客户**和**服务器**。

### 接入网

**接入网**是指将端系统物理连接到其**边缘路由器**的网络。**边缘路由器**是指端系统到任何其他远程端系统的路径上的**第一台路由器**。

```mermaid
graph LR
端系统--接入网-->边缘路由器-->A[..]-->其他远程路由器
```

类别：

- 家庭接入：

  - **数字用户线（DSL）**：用户的本地电话公司是它的 ISP

    **频分复用**：高速下行信道（50kHz ~ 1MHz）、中速上行信道（4kHz ~ 50kHz）、普通的双向电话信道（0 ~ 4kHz）

    传输速率：12Mbps 下行和 1.8Mbps 上行或 55Mbps 下行和 15Mbps 上行

  - **电缆**：电缆调制解调器将 HFC 网络划分为下行（42.8Mbps）和上行（30.7Mbps）两个信道

    **混合光纤同轴（HFC）**：光缆将电缆头端连接到地区枢纽，从这里使用传统的同轴电缆到达各家各户

    特征：**共享广播媒体** - 由头端发送的每个分组向下经每段链路到每个家庭；每个家庭发送的每个分组经上行信道向头端传输

  - **光纤到户（FTTH）**：从本地中心局直接到家庭提供了一条光纤路径，每秒千兆比特，平均下行速率 20Mbps

    分为有源光纤网络（AON 以太网）和无源光纤网络（PON）

- 企业接入：

  - **以太网**：用户使用**双绞铜线**与一台以太网交换机连接
  - **WiFi**

- 广域无线接入：

  - **3G、4G 蜂窝网络**
  - LTE：长期演进，来源于 3G 技术，> 10Mbps

### 物理媒体

- 导引型媒体：电波沿着**固体**媒体前行
  - **光纤**：高速（几十到几百 Gbps），耐干扰，难窃听，长距离
  - **双绞铜线**：便宜，短距离，10Mbps ~ 10Gbps
  - **同轴电缆**：能被用作导引型**共享媒体**，许多端系统能够直接与该电缆相连，每个端系统都能接收由其他端系统发送的内容
- 非引导性媒体：电波在**空气或外层空间**中传播
  - 陆地**无线电**信道：长距离，依赖于传播环境，分为三类：短距离（1 ~ 2米，个人设备）；局域（几十到几百米，无线 LAN）；广域（数万米，蜂窝）
  - 数字**卫星**频道（卫星无线电信道）：两类卫星：同步卫星和近地轨道卫星，时延大，速度快（数百 Mbps），通常用于无法使用 DSL 或电缆因特网接入的区域

## 1.3 网络核心

网络核心即互联因特网端系统的**分组交换机和链路**构成的网状网络。在网络应用中，端系统彼此交换**报文**，报文可以执行一种**控制功能**。

### 分组交换

报文被划分为较小的数据块，通过通信链路和分组交换机传输。

> 如果某源端系统或分组交换机经过一条链路发送一个 L 比特的分组，链路的传输速率为 R 比特/秒，则传输该分组的时间为 L/R 秒。

#### ① 存储转发传输

存储转发传输是指在交换机能够开始向输出链路传输该分组的第一个比特之前，必须**接收到整个分组**，即接收的过程中先**缓存**该分组之前传输的比特。

> - 源在时刻 0 开始传输，L/R 时刻时接收到了整个分组，2L/R 时刻时传输了整个分组，总时延为 2L/R
> - 后续的第二个分组在 2L/R 时刻被完整接收，在 3L/R 时刻被完整传输
> - 所以，通过由 N 条速率均为 R 的链路组成的路径（N-1 台路由器），从源到目的地发送一个分组，端到端时延为 $d_{端到端} = N\frac{L}{R}$
> - P 个分组经过 N 条链路的时延为：$d = (N+P-1)\frac{L}{R}$

#### ② 排队时延

每个分组交换机都有输出缓存（输出队列），用于存储路由器准备发送的分组。如果到达的分组需要传输到某条链路，但那条链路正忙于传输其他分组，则该到达分组必须在输出缓存中**等待**。

#### ③ 分组丢失

缓存空间的大小有限，所以一个到达的分组可能发现缓存已满，则会出现分组丢失（丢包），到达的分组或**已经排队的分组之一**将被丢弃。

#### ④ 转发表和路由选择协议

每个端系统都有一个 IP 地址，分组的首部包含了目的 IP 地址。每台路由器具有一个转发表，用于将目的地址映射成为输出链路。路由选择协议用于自动地设置这些转发表。

### 电路交换

在电路交换网络中，在端系统间通信会话期间，**预留**了端系统间沿路径通信所需要的资源（缓存、链路传输速率）。比如**电话网络**，在通话期间，路径上的交换机始终在发送方和接收方之间维护连接状态，即预留了带宽，确保传输速率的恒定。

① **频分复用（FDM）**

在连接期间链路为每条连接专用一个**频段**，频段的宽度称为**带宽**。

② **时分复用（TDM）**

时间被划分为固定期间的**帧**，每个帧又被划分为固定数量的**时隙**，**每个连接被指定一个时隙**。在循环的 TDM 帧中每条电路被分配相同的专用时隙。

> 如果链路每秒传输 8000 个帧，每个时隙由 8 个比特组成，则每条电路的传输速率是 64kbps（电路传输速率 = 帧速率 * 每个时隙的比特数量）

但电路交换存在**静默期**，即连接后未使用网络资源（但占用了连接）。

### 报文交换

以报文为传输单位，而不将报文划分为较小的数据块。

### 分组交换和电路交换的对比

- 分组交换不适合实时服务（电话、视频会议），因为端到端时延不可预测
- 电路交换可能会使得已分配和不需要的链路时间未被利用

### 网络的网络

① 网络结构1：单一的全球传输 ISP 互联所有接入 JSP

② 网络结构2：两层结构，多个全球 ISP 与接入 ISP 互联，但每个接入 ISP 只能与单个全球 ISP 互联

③ 网络结构3：接入ISP -> 区域 ISP -> 第一层 ISP

④ 网络结构4：

- **存在点（PoP）**：提供商网络中的一台或多台路由器（在相同位置）群组，存在于除底层以外的所有层次。对于要与提供商 PoP 连接的客户网络，它能从第三方电信提供商租用高速链路将它的路由器之一直接连接到位于该 PoP 的一台路由器。
- **多宿**：除了第一层 ISP，任何 ISP 都可以与两个或更多提供商 ISP 连接
- **对等**：位于相同等级结构层次的邻近一对 ISP 能够对等，直接将网络连到一起，不经过上游的 ISP，减少费用
- **因特网交换点（IXP）**：是一个**汇合点**，多个 ISP 在这里一起对等

⑤ 网络结构5：在网络结构 4 顶部增加了**内容提供商网络**，独立于公共互联网，可以与较低层 ISP 对等（直接连接或在 IXP 处连接）。较低层的 ISP 与较高层 ISP 相连，较高层 ISP 彼此互联，主要的内容提供商也可以创建自己的网络，与较低层 ISP 互联。

## 1.4 分组交换网中的时延、丢包和吞吐量

### 时延

类型：

- 处理时延：检查分组首部和决定将该分组导向何处所需要的时间，以及其他因素（如检查比特级别的差错）。微秒或更低的数量级。
- 排队时延：分组在链路上等待传输的时间。到达分组期待发现的分组数量是到达该队列的流量的强度和性质的函数。毫秒到微秒量级。
- 传输时延：将所有分组的比特推向链路所需要的时间（L/R）。毫秒到微秒量级。
- 传播时延：一个比特在链路上传输的时间，取决于物理媒体和两台路由器之间的距离（d/s）。毫秒量级。

$$d_{nodal}=d_{proc}+d_{queue}+d_{trans}+d_{prop}$$

**排队时延**：取决于流量到达该队列的速率（La），链路的传输速率（R）和到达流量的性质（周期性 or 突发）。如果分组以突发形式到达，则平均排队时延可能会很大，第 n 个分组具有 (n-1) L/R 秒的时延。

**流量强度**：设 a 为分组到达队列的平均速率（分组/秒，pkt/s），L 为分组的比特数量，R 是链路的传输速率，所以流量强度 = La/R。**流量强度不能大于 1**，否则排队时延会趋向无限大（$W_q=\frac{\rho}{2\mu(1-\rho)}$)。

> 一般化的**端到端时延**：源和目的主机之间有 N-1 台路由器，链路上的传输速率为 R bps，并且忽略排队时延
>
> 则端到端时延：$d_{端到端}=N(d_{proc}+d_{trans}+d_{prop})$，其中 $d_{trans} = L/R$

### 丢包

缓存队列若满，则路由器会丢弃分组，被丢弃的分组可能会被重传

### 吞吐量

瞬时吞吐量：某个时刻的传输速率

平均吞吐量：T 秒接收 F 比特，则为 F/T bps

可用吞吐量：发送进程能够向接收进程交付比特的速率

吞吐量是**瓶颈链路**的传输速率，$min{\{R_1,R_2,\dots,R_N\}}$

## 1.5 协议层次及其服务模型

|  层级  |   传送的数据   |      协议       |     实例     |
| :----: | :------------: | :-------------: | :----------: |
| 应用层 |      报文      | HTTP、SMTP、FTP |   应用程序   |
| 运输层 | 报文段（分组） |    TCP、UDP     |              |
| 网络层 |     数据报     |       IP        |    路由器    |
| 链路层 |       帧       |                 | 链路层交换机 |
| 物理层 |      比特      |                 |   物理媒体   |

> 7层模型：应用层-表示层-会话层-运输层-网络层-链路层-物理层

## 1.6 网络安全

**病毒**：需要某种形式的**用户交互**来感染用户设备的恶意软件

**蠕虫**：**无须任何明显用户交互**就能进入设备的恶意软件

**拒绝服务攻击（DoS）**：弱点攻击、带宽洪泛、连接洪泛

**分组嗅探器**：记录每个游经的分组副本的被动接受机

**IP 哄骗**：将具有虚假源地址的分组注入因特网的能力

**端点鉴别**：一种使我们能够确信一个报文源自我们认为它应当来自的地方的机制

## 英文术语

|          中文          |              英文               | 英文缩写 |
| :--------------------: | :-----------------------------: | :------: |
|          主机          |              host               |          |
|         端系统         |           end system            |          |
|        通信链路        |       communication link        |          |
|       分组交换机       |          packet switch          |          |
|          分组          |             packet              |          |
|         路由器         |             router              |          |
|      链路层交换机      |        link-layer switch        |          |
|          路径          |           route/path            |          |
|    因特网服务提供商    |    Internet Service Provider    |   ISP    |
|      传输控制协议      |  Transmission Control Protocol  |   TCP    |
|        网际协议        |        Internet Protocol        |    IP    |
|    因特网工程任务组    | Internet Engineering Task Force |   IETF   |
|        请求评论        |       Request For Comment       |   RFC    |
|     分布式应用程序     |     distributed application     |          |
|       套接字接口       |        socket interface         |          |
|          客户          |             client              |          |
|         服务器         |             server              |          |
|       边缘路由器       |           edge router           |          |
|       数字用户线       |     Digital Subscriber Line     |   DSL    |
|  数字用户线接入复用器  |                                 |  DSLAM   |
|     电缆因特网接入     |      cable Internet access      |          |
|      混合光纤同轴      |        Hybrid Fiber Coax        |   HFC    |
| 电缆调制解调器端接系统 | Cable Modem Termination System  |   CMTS   |
|        光纤到户        |        Fiber To The Home        |   FTTH   |
|      有源光纤网络      |     Active Optical Network      |   AON    |
|      无源光纤网络      |     Passive Optical Network     |   PON    |
|     光纤网络端接器     |   Optical Network Terminator    |   ONT    |
|         分配器         |            splitter             |          |
|     光纤线路端接器     |     Optical Line Terminator     |   OLT    |
|      无屏蔽双绞线      |     Unshielded Twisted Pair     |   UTP    |
|          报文          |             message             |          |
|      存储转发传输      | store-and-forward transmission  |          |
|          丢包          |           packet loss           |          |
|         转发表         |        forwarding table         |          |
|        电路交换        |        circuit switching        |          |
|        分组交换        |        packet switching         |          |
|       端到端连接       |      end-to-end connection      |          |
|        频分复用        | Frequency-Division Multiplexing |   FDM    |
|        时分复用        |   Time-Division Multiplexing    |   TDM    |
|          带宽          |            bandwidth            |          |
|         静默期         |          slient period          |          |
|         存在点         |        Point of Presence        |   PoP    |
|          多宿          |           muitl-home            |          |
|          对等          |              peer               |          |
|      因特网交换点      |     Internet Exchange Point     |   IXP    |
|      节点处理时延      |     nodal procession delay      |          |
|        排队时延        |          queuing delay          |          |
|        传输时延        |       transmission delay        |          |
|        传播时延        |        propagation delay        |          |
|       节点总时延       |        total nodal delay        |          |
|        流量强度        |        traffic intensity        |          |
|         吞吐量         |           throughput            |          |
|        瓶颈链路        |         bottleneck link         |          |
|         报文段         |             segment             |          |
|         数据报         |            datagram             |          |
|           帧           |              frame              |          |
|          封装          |          encapsulation          |          |
|      有效载荷字段      |          payload field          |          |
|         应用层         |        application layer        |          |
|         运输层         |         transport layer         |          |
|         网络层         |          network layer          |          |
|         链路层         |           link layer            |          |
|         物理层         |         physical layer          |          |
|        恶意软件        |             malware             |          |
|        僵尸网络        |             botnet              |          |
|          病毒          |              virus              |          |
|          蠕虫          |              worm               |          |
|      拒绝服务攻击      |        Denial-of-Service        |   DoS    |
|       分组嗅探器       |         packet sniffer          |          |
|        IP 哄骗         |           IP spoofing           |          |