---
title: 数据库原理——数据库安全性
date: 2020-05-04 21:39:10
tags: 
- Database
categories:
- Database
toc: true
reward: true
---

<!--more-->

## 数据库安全性概述

数据库的安全性是指保护数据库以防止不合法使用所造成的数据泄露、更改或破坏。

数据库管理系统提供的安全措施主要包括**用户身份鉴别、存取控制（自主存取控制和强制存取控制）、审计、视图、数据加密存储和加密传输等**。

## 安全标准

$TCSEC/TDI$ 安全级别划分：
$A1\rightarrow B3\rightarrow B2\rightarrow B1\rightarrow C2\rightarrow C1\rightarrow D$ 四组七个等级 安全级别逐渐降低

$B1$ 标记安全保护 **所有**的主体和客体都标记

$C1$ 自主安全保护 

## 用户身份鉴别

主要通过：

- 静态口令鉴别
- 动态口令鉴别
- 生物特征鉴别
- 智能卡鉴别

## 安全性控制

存取控制：定义用户权限、合法权限检查

1. **自主存取控制** （$DAC$） $C1$ 级
-  用户对不同的数据对象有不同的存取权限
- 不同用户对同一对象也有不同的权限
- 用户还可以转授权限 

2. **强制存取控制**（$MAC$）$B1$ 级 
- 每一个数据对象被标以一定的密级
- 每一个用户也被授予一个等级的许可证
- 对于任意一个对象，只有具有合法许可证的用户才可以存取

### 自主存取控制

#### `GRANT` 语句 授予权限

**语法**

```SQL
GRANT 权限名
ON 对象名
TO 用户名
[WITH GRANT OPTION] （可转授权限）
```

::: danger
注意：不允许循环授权
:::

#### `REVOKE` 语句 收回权限

**语法**

```SQL
REVOKE 权限名
ON 对象名
FROM 用户名[CASCADE|RESTRICT]
```

::: tip
`CASCADE`级联收回权限
:::

#### 创建数据库模式的权限

**语法**

```SQL
CREATE USER <username> [WITH] [DBA|RESOURCE|CONNECT]
```

> `CREATE USER` 语句不是 `SQL` 标准，不同的 $DBMS$ 语法相差甚远

::: tip
- 只有系统超级用户才有权限创建一个新的数据库用户
- 新创建的数据库用户有三种权限：`CONNCET, RESOURCE, DBA`
- 默认的权限是 `CONNECT`，拥有该权限的用户不能创建新用户、新模式、基本表，**只能登录数据库**
- 拥有 `RESOURCE` 权限的用户可以创建基本表和视图（可以转授权限），但**不能创建模式和用户**
- 拥有 `DBA` 权限的用户是超级用户，可以创建用户、模式、基本表和视图等，并可以转授权限
:::

#### 数据库角色

数据库角色：被命名的**一组**与数据库操作相关的权限
- 角色是权限的**集合**
- 可以为一组具有相同权限的用户创建一个角色

```SQL
-- 创建角色
CREATE ROLE 角色名

-- 给角色授权
GRANT 权限名
ON 对象名
TO 角色名

-- 将一个角色授予其他的用户或角色
GRANT 角色名
TO 角色名
[WITH ADMIN OPTION]

-- 角色权限的收回
REVOKE 权限名
ON 对象名
FROM 角色名
```

#### 自主存取控制的缺点

- 可能存在数据的无意泄漏

### 强制存取控制

**主体**是系统中的活动实体
- 数据库管理系统所管理的实际用户
- 代表用户的各进程

**客体**是系统中的被动实体，是受主体操纵的
- 文件、基本表、索引、视图等

对于主体和客体，数据库管理系统为它们每个实例指派一个**敏感度标记**，分为：绝密、机密、可信、公开（$TS\rightarrow S \rightarrow C \rightarrow P$)

- 主体的许可证**大于或等于**客体的密级时，主体才能**读**取对应的客体。
- 主体的许可证**小于或等于**客体的密级时，主体才能**写**相应的客体。

实现强制控制存取时首先要实现自主存取控制（较高安全级别包括较低级别）
自主存取控制与强制存取控制共同构成 $DBMS$ 的安全机制

## 视图

- 视图机制把要加密的数据对无权存取的用户**隐藏**起来，从而自动地对数据提供一定程度的安全保护。
- 即间接地实现支持存取谓词的用户权限定义。

```sql
/* 允许王平只能检索计算机系学生的信息
允许张明可以检索并增删改计算机系学生的信息 */

-- 先建立计算机系学生的视图
CREATE VIEW CS_Student
AS
SELECT *
FROM Student
WHERE Sdept = 'CS'

-- 王平只能检索
GRANT SELECT
ON CS_Student
TO 王平

-- 张明可以检索和增删改（即所有权限）
GRANT ALL PRIVILEGES
ON CS_Student
TO 张明
```

## 审计

- 审计功能把用户对数据库的所有操作自动记录下来放入审计日志中
- $C2$ 级别以上必须有审计功能

审计事件：

- 服务器事件
- 系统权限
- 语句事件
- 模式对象事件

审计功能：

- 基本功能，提供多种审计查阅方式：基本的、可选的、有限的等
- 提供多套审计规则
- 提供审计分析和报表功能
- 审计日志管理功能
- 系统提供查询审计设置及审计记录信息的专门视图

## 数据加密

- 数据加密是防止数据库数据在存储和传输中失密的有效手段
- 加密的基本思想是根据一定的算法将原始数据——明文变换为不可直接识别的格式——密文
- 数据加密主要包括**存储加密和传输加密（链路加密和端到端加密）**

## 其他安全性保护

- 推理控制
- 隐蔽信道